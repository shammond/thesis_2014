# Test 5 - check put/get behavior when a per-character delay is specified
# ======   by a delay statement
#

sp_create localhost 16001       # OK
sp_open ttyS3                   # OK
sp_delay 10
sp_put a_line
sp_put another_line
sp_put a_very_much_longer_set_of_characters_to_build_things_out_to_here
sp_put x
sp_put EOF
sp_sleep 0 0
sp_reset f T f                  # Clear the transmission delay
sp_close
sp_close TRUE

pause 1000                      # Wait for connections to reset

sp_open ttyS3
sp_delay 10
sp_sleep 80 500                 # Let the buffer fill
sp_get 80                       # Read 80 characters
sp_sleep 6 0                    # Read 6 characters
sp_get 6
sp_sleep 0 0
sp_get 10                       # Should get nothing
sp_reset 0 T 0                  # Clear the Tx delay
sp_close
sp_delete

#
# End of test: no errors expected
#
